<div class="table-responsive">
    <div class="cover"></div>
    <table class="table table-payroll table-sm table-striped">
        <thead>
            <tr class="text-center">
                <th></th>
                <th></th>
                <th></th>
                <th></th>
                <th></th>
                <th></th>
                <th></th>
                <th></th>
                <th colspan="3">Tax</th>
                <th colspan="3">SSS</th>
                <th></th>
                <th></th>
                <th></th>
            </tr>
            <tr class="text-center">
                <th></th>
                <th>Name</th>
                <th>Position</th>
                <th>Daily</th>
                
                <th>No. of Days Rendered</th>
                <th>Gross Amount</th>
                {% for incentive in payroll.incentives %}
                    <th>{{incentive.name}}</th>
                {% endfor %}
                <th>Total</th>

                {% for deduction in payroll.deductions|customFilter({groupName: 'Tax'}) %}
                    <th>{{deduction.name}}</th>
                {% endfor %}
                <th>Total Tax</th>

                {% for deduction in payroll.deductions|customFilter({groupName: 'SSS'}) %}
                    <th>{{deduction.name}}</th>
                {% endfor %}
                <th>Total SSS</th>
               
                <th>Total Deductions</th>
                <th>Net Amount Received</th>
                <th></th>
            </tr>
        </thead>
        <tbody id="sortMe">
           
            <tr v-for="(row, rowIndex) in payroll.rows" class="drag-employment" v-bind:data-ruid="row.uid">
                <template v-if="row.type===1">
                    <td style="padding:0; text-align:center; vertical-align: middle;">
                        <svg class="dragMe" style="cursor: move; width:24px;height:24px; opacity: 0.4" viewBox="0 0 24 24">
                            <path fill="currentColor" d="M7,19V17H9V19H7M11,19V17H13V19H11M15,19V17H17V19H15M7,15V13H9V15H7M11,15V13H13V15H11M15,15V13H17V15H15M7,11V9H9V11H7M11,11V9H13V11H11M15,11V9H17V11H15M7,7V5H9V7H7M11,7V5H13V7H11M15,7V5H17V7H15Z" />
                        </svg>
                    </td>
                    <td>${row.employee.lastName}, ${row.employee.firstName} <u>${_.first(row.employee.middleName)}</u></td>
                    <td>${row.employment.position}</td>
                    <td>${row.employment.salary|currency}</td>
                    <td>
                        <a target="_blank" v-bind:href="`http://localhost:9094/attendance/employee/employment/${row.employee._id}/${row.employment._id}?month=${moment(payroll.dateStart).format('MMM')}&amp;year=${moment(payroll.dateStart).format('YYYY')}&amp;undertime=1`" class="d-flex">
                            <div>${row.timeRecord.renderedDays} days</div>
                            <div class="pl-2 pr-2">${row.timeRecord.renderedHours} hrs</div>
                            <div>${row.timeRecord.renderedMinutes} mins</div>
                        </a>
                    </td>
                    <td>${row.computed.amountWorked|currency}</td>
                    <td v-for="incentive in row.incentives">${incentive.amount|currency}</td>
                    <td>${getTotalIncentives(row.incentives)+row.computed.amountWorked | currency}</td>
                    <td v-for="deduction in filterBy(row.deductions, ['groupName', 'Tax'])">
                        <input v-on:blur="lockInput($event)" type="text" v-bind:value="deduction.amount" v-on:input="inputMoney($event, deduction)">
                        <span class="text-danger" v-on:dblclick="editInput($event, deduction.deductionType)">${deduction.amount | currency}</span>
                    </td>
                    <td>${getTotalDeductions(filterBy(row.deductions, ['groupName', 'Tax'])) | currency}</td>
                    <td v-for="deduction in filterBy(row.deductions, ['groupName', 'SSS'])">
                        <input v-on:blur="lockInput($event)" type="text" v-bind:value="deduction.amount" v-on:input="inputMoney($event, deduction)">
                        <span class="text-danger" v-on:dblclick="editInput($event, deduction.deductionType)">${deduction.amount | currency}</span>
                    </td>
                    <td>${getTotalDeductions(filterBy(row.deductions, ['groupName', 'SSS'])) | currency}</td>
                    <td>${getTotalDeductions(row.deductions) | currency}</td>
                    <td>${row.computed.amountWorked + getTotalIncentives(row.incentives) - getTotalDeductions(row.deductions) | currency}</td>
                    <td><button v-on:click="deleteRow(rowIndex)" class="btn btn-sm text-danger">X</button></td>
                
                </template>
                <template v-if="row.type===2">
                    <td style="padding:0; text-align:center; vertical-align: middle;">
                        <svg class="dragMe" style="cursor: move; width:24px;height:24px; opacity: 0.4" viewBox="0 0 24 24">
                            <path fill="currentColor" d="M7,19V17H9V19H7M11,19V17H13V19H11M15,19V17H17V19H15M7,15V13H9V15H7M11,15V13H13V15H11M15,15V13H17V15H15M7,11V9H9V11H7M11,11V9H13V11H11M15,11V9H17V11H15M7,7V5H9V7H7M11,7V5H13V7H11M15,7V5H17V7H15Z" />
                        </svg>
                    </td>
                    <td colspan="4">Grand Total &gt;&gt;&gt;</td>
                    <td>${getSubTotal('computed.amountWorked') | currency}</td>
                    <td>${getIncentivesSubTotal('5Premium') | currency}</td>
                    <td>${getTotalX() | currency}</td>
                    <td colspan="7"></td>
                    <td>${getTotalY() | currency}</td>
                    <td><button v-on:click="deleteRow(rowIndex)" class="btn btn-sm text-danger">X</button></td>

                </template>
                <template v-if="row.type===3">
                    <td style="padding:0; text-align:center; vertical-align: middle;">
                        <svg class="dragMe" style="cursor: move; width:24px;height:24px; opacity: 0.4" viewBox="0 0 24 24">
                            <path fill="currentColor" d="M7,19V17H9V19H7M11,19V17H13V19H11M15,19V17H17V19H15M7,15V13H9V15H7M11,15V13H13V15H11M15,15V13H17V15H15M7,11V9H9V11H7M11,11V9H13V11H11M15,11V9H17V11H15M7,7V5H9V7H7M11,7V5H13V7H11M15,7V5H17V7H15Z" />
                        </svg>
                    </td>
                    <td>
                        <input v-on:blur="lockText($event)" type="text" v-bind:value="row.name" v-on:input="row.name = $event.target.value">
                        <span v-on:dblclick="editText($event)">${row.name}</span>
                    </td>
                    <td colspan="14"></td>
                    <td><button v-on:click="deleteRow(rowIndex)" class="btn btn-sm text-danger">X</button></td>
                </template>
            </tr>
            
        </tbody>
    </table>

</div> 
<div class="form-inline mt-3">
    <div class="col-md-6">
        <button type="button" v-on:click="addRow(2)" class="btn btn-primary btn-sm">Add Sub Total Row</button>
        <button type="button" v-on:click="addRow(3)" class="btn btn-primary btn-sm">Add Fund Source Row</button>
        <button type="button" v-on:click="saveMe" class="btn btn-primary btn-sm">Save</button>
        <a href="/payroll/employees/{{payroll._id}}/payroll.xlsx" class="btn btn-light btn-sm">Download</a>
    </div>
</div>
